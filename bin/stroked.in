#!/usr/bin/env python3

import os
import sys
import gettext
import locale


version = '@version@'
pkgdatadir = '@pkgdatadir@'
localedir = '@localedir@'
srcdir = pkgdatadir
builddir = os.environ.get('MESON_BUILD_ROOT')
if builddir:
    pkgdatadir = os.path.join(builddir, 'data')
    srcdir = os.environ.get('MESON_SOURCE_ROOT')

locale.setlocale(locale.LC_ALL, '')
locale.bindtextdomain('stroked', localedir)
locale.textdomain('stroked')

gettext.bindtextdomain('stroked', localedir)
gettext.textdomain('stroked')
gettext.install('stroked', localedir)

sys.path.insert(1, srcdir)

if __name__ == "__main__":
    from gi.repository import Gio
    resource = Gio.Resource.load(os.path.join(pkgdatadir, 'stroked.gresource'))
    resource._register()

    from stroked import app
    app.main(version=version)
